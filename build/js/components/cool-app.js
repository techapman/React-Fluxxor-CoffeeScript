// Generated by CoffeeScript 1.9.2
(function() {
  var Application, FluxMixin, Fluxxor, React, StoreWatchMixin, TodoItem;

  Fluxxor = require('fluxxor');

  React = require('react/addons');

  FluxMixin = Fluxxor.FluxMixin(React);

  StoreWatchMixin = Fluxxor.StoreWatchMixin;

  TodoItem = require('./todo-item');

  Application = React.createClass({
    mixins: [FluxMixin, StoreWatchMixin('TodoStore')],
    getInitialState: function() {
      return {
        newTodoText: ''
      };
    },
    getStateFromFlux: function() {
      var TodoFluxxor;
      TodoFluxxor = this.getFlux();
      return TodoFluxxor.store('TodoStore').getState();
    },
    handleTodoTextChange: function(e) {
      return this.setState({
        newTodoText: e.target.value
      });
    },
    onSubmitForm: function(e) {
      e.preventDefault();
      if (this.state.newTodoText.trim()) {
        this.getFlux().actions.addTodo(this.state.newTodoText);
        return this.setState({
          newTodoText: ''
        });
      }
    },
    clearCompletedTodos: function(e) {
      return this.getFlux().actions.clearTodos();
    },
    render: function() {
      var button, div, form, input, li, ref, ul;
      ref = React.DOM, div = ref.div, ul = ref.ul, li = ref.li, form = ref.form, input = ref.input, button = ref.button;
      return div({
        id: 'TODOAPPDIV'
      }, [
        ul({
          key: 'allTodosList'
        }, this.state.todos.map(function(currentTodo, i) {
          return li({
            key: currentTodo.id
          }, [
            React.createElement(TodoItem, {
              todo: currentTodo,
              key: i
            })
          ]);
        })), form({
          onSubmit: this.onSubmitForm,
          key: 'todoInputForm'
        }, [
          input({
            type: 'text',
            size: '30',
            placeholder: 'New Todo',
            value: this.state.newTodoText,
            ref: 'todoInputText',
            key: 'todoInputText',
            onChange: this.handleTodoTextChange
          }), input({
            type: 'submit',
            value: 'Add Todo',
            ref: 'todoInputSubmit',
            key: 'todoInputSubmit'
          })
        ]), button({
          onClick: this.clearCompletedTodos,
          key: 'clearCompletedButton'
        }, 'Clear Completed')
      ]);
    }
  });

  module.exports = Application;

}).call(this);
